<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –≥–æ–ª–æ—Å–∞ JARVIS</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #f5f5f5;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .test-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: background 0.2s;
        }
        .test-btn:hover {
            background: #0056b3;
        }
        .voice-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
            border-left: 4px solid #007bff;
        }
        .voices-list {
            max-height: 200px;
            overflow-y: auto;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé§ –¢–µ—Å—Ç –≥–æ–ª–æ—Å–∞ JARVIS</h1>
        
        <div class="voice-info">
            <h3>–¢–µ–∫—É—â–∏–π –≥–æ–ª–æ—Å:</h3>
            <div id="currentVoice">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>

        <button class="test-btn" onclick="testMaleVoice()">üéØ –¢–µ—Å—Ç –º—É–∂—Å–∫–æ–≥–æ –≥–æ–ª–æ—Å–∞</button>
        <button class="test-btn" onclick="testJarvisPhrase()">ü§ñ –¢–µ—Å—Ç —Ñ—Ä–∞–∑—ã JARVIS</button>
        <button class="test-btn" onclick="showAllVoices()">üìã –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –≥–æ–ª–æ—Å–∞</button>
        <button class="test-btn" onclick="testDefaultVoice()">‚ö†Ô∏è –¢–µ—Å—Ç –¥–µ—Ñ–æ–ª—Ç–Ω–æ–≥–æ –≥–æ–ª–æ—Å–∞</button>

        <div id="voicesList" class="voices-list" style="display: none;"></div>

        <div class="voice-info">
            <h3>üéØ –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º:</h3>
            <p>‚úÖ –ú—É–∂—Å–∫–æ–π ÔøΩÔøΩ–æ–ª–æ—Å (–Ω–µ –∂–µ–Ω—Å–∫–∏–π)</p>
            <p>‚úÖ –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ –±–µ–∑ –∞–∫—Ü–µ–Ω—Ç–∞</p>
            <p>‚úÖ –ù–∏–∑–∫–∏–π —Ç–æ–Ω (pitch = 0.8)</p>
            <p>‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å (rate = 0.85)</p>
        </div>
    </div>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –ª—É—á—à–µ–≥–æ –º—É–∂—Å–∫–æ–≥–æ –≥–æ–ª–æ—Å–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –∫–∞–∫ –≤ JARVIS)
        function getBestMaleVoice() {
            const voices = speechSynthesis.getVoices();
            let selectedVoice = null;

            console.log('üîç –ü–æ–∏—Å–∫ –≥–æ–ª–æ—Å–æ–≤. –í—Å–µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ:', voices.length);

            // –õ–æ–≥–∏—Ä—É–µ–º –≤—Å–µ —Ä—É—Å—Å–∫–∏–µ –≥–æ–ª–æ—Å–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            const russianVoices = voices.filter(v => v.lang.includes('ru') || v.lang.includes('RU'));
            console.log('üá∑üá∫ –†—É—Å—Å–∫–∏–µ –≥–æ–ª–æ—Å–∞:', russianVoices.map(v => `${v.name} (${v.lang}) ${v.localService ? '[–õ–æ–∫–∞–ª—å–Ω—ã–π]' : '[–û–Ω–ª–∞–π–Ω]'}`));

            // –ü–†–ò–û–†–ò–¢–ï–¢ 1: –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –º—É–∂—Å–∫–∏–µ –≥–æ–ª–æ—Å–∞
            const maleVoiceNames = [
                'Microsoft Pavel',
                'Pavel',
                'Yuri',
                'Maxim',
                'Dmitri',
                'Aleksandr',
                'Google —Ä—É—Å—Å–∫–∏–π –º—É–∂—Å–∫–æ–π',
                'Russian Male'
            ];

            for (const maleName of maleVoiceNames) {
                selectedVoice = russianVoices.find(v =>
                    v.name.toLowerCase().includes(maleName.toLowerCase())
                );
                if (selectedVoice) {
                    console.log('‚úÖ –ù–∞–π–¥–µ–Ω –º—É–∂—Å–∫–æ–π –≥–æ–ª–æ—Å:', selectedVoice.name);
                    break;
                }
            }

            // –ü–†–ò–û–†–ò–¢–ï–¢ 2: –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≥–æ–ª–æ—Å–∞ (–ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ)
            if (!selectedVoice) {
                const qualityVoices = [
                    'Google —Ä—É—Å—Å–∫–∏–π',
                    'Microsoft Irina - Russian (Russia)', // –•–æ—Ç—è –∂–µ–Ω—Å–∫–∏–π, –Ω–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π
                    'Russian (Russia)',
                    'ru-RU'
                ];

                for (const quality of qualityVoices) {
                    selectedVoice = russianVoices.find(v =>
                        v.name.includes(quality) && v.localService
                    );
                    if (selectedVoice) {
                        console.log('‚úÖ –ù–∞–π–¥–µ–Ω –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π –≥–æ–ª–æ—Å:', selectedVoice.name);
                        break;
                    }
                }
            }

            // –ü–†–ò–û–†–ò–¢–ï–¢ 3: –õ—é–±–æ–π —Ä—É—Å—Å–∫–∏–π –≥–æ–ª–æ—Å
            if (!selectedVoice) {
                selectedVoice = russianVoices.find(v => v.localService) || russianVoices[0];
                if (selectedVoice) {
                    console.log('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –≥–æ–ª–æ—Å:', selectedVoice.name);
                }
            }

            return selectedVoice;
        }

        function speakWithSettings(text, voice = null, customSettings = {}) {
            speechSynthesis.cancel();
            
            const utterance = new SpeechSynthesisUtterance(text);
            
            if (voice) {
                utterance.voice = voice;
            }
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–∫ –≤ JARVIS (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ)
            utterance.lang = customSettings.lang || 'ru-RU';
            utterance.rate = customSettings.rate || 0.8;   // –ú–µ–¥–ª–µ–Ω–Ω–µ–µ –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏
            utterance.pitch = customSettings.pitch || 0.7; // –ï—â–µ –Ω–∏–∂–µ –¥–ª—è –º—É–∂—Å–∫–æ–≥–æ –≥–æ–ª–æ—Å–∞
            utterance.volume = customSettings.volume || 0.95; // –ü–æ—á—Ç–∏ –º–∞–∫—Å–∏–º—É–º
            
            speechSynthesis.speak(utterance);
        }

        function testMaleVoice() {
            const bestVoice = getBestMaleVoice();
            const text = "–ü—Ä–∏–≤–µ—Ç! –Ø –î–ñ–ê–†–í–ò–°. –≠—Ç–æ –º–æ–π –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º—É–∂—Å–∫–æ–π –≥–æ–ª–æ—Å. –ó–≤—É—á—É –ª–∏ —è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –∏ –±–µ–∑ —Ä–æ–±–æ—Ç—Å–∫–æ–≥–æ –∞–∫—Ü–µ–Ω—Ç–∞?";

            if (bestVoice) {
                document.getElementById('currentVoice').innerHTML = `
                    <strong>${bestVoice.name}</strong><br>
                    –Ø–∑—ã–∫: ${bestVoice.lang}<br>
                    –õ–æ–∫–∞–ª—å–Ω—ã–π: ${bestVoice.localService ? '–î–∞' : '–ù–µ—Ç'}<br>
                    <span style="color: ${bestVoice.name.toLowerCase().includes('pavel') || bestVoice.name.toLowerCase().includes('yuri') || bestVoice.name.toLowerCase().includes('male') ? 'green' : 'orange'}">
                        ${bestVoice.name.toLowerCase().includes('pavel') || bestVoice.name.toLowerCase().includes('yuri') || bestVoice.name.toLowerCase().includes('male') ? '‚úÖ –ú—É–∂—Å–∫–æ–π' : '‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω–æ –∂–µ–Ω—Å–∫–∏–π'}
                    </span>
                `;
                speakWithSettings(text, bestVoice);
            } else {
                document.getElementById('currentVoice').innerHTML = '<span style="color: red;">‚ùå –†—É—Å—Å–∫–∏–π –≥–æ–ª–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω</span>';
                speakWithSettings(text);
            }
        }

        function testJarvisPhrase() {
            const bestVoice = getBestMaleVoice();
            const text = "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –Ø –î–ñ–ê–†–í–ò–° - –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —É–º–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫. –ú–æ–π –≥–æ–ª–æ—Å –¥–æ–ª–∂–µ–Ω –∑–≤—É—á–∞—Ç—å –º—É–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ.";
            speakWithSettings(text, bestVoice);
        }

        function testDefaultVoice() {
            const text = "–≠—Ç–æ –æ–±—ã—á–Ω—ã–π –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –≥–æ–ª–æ—Å —Å–∏—Å—Ç–µ–º—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è. –û–Ω –¥–æ–ª–∂–µ–Ω —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –î–ñ–ê–†–í–ò–°.";
            speakWithSettings(text, null, { pitch: 1.0, rate: 1.0 });
        }

        function showAllVoices() {
            const voices = speechSynthesis.getVoices();
            const russianVoices = voices.filter(v => v.lang.includes('ru') || v.lang.includes('RU'));
            
            const list = document.getElementById('voicesList');
            list.style.display = list.style.display === 'none' ? 'block' : 'none';
            
            if (list.style.display === 'block') {
                list.innerHTML = `
                    <h4>–î–æ—Å—Ç—É–ø–Ω—ãÔøΩÔøΩ —Ä—É—Å—Å–∫–∏–µ –≥–æ–ª–æ—Å–∞ (${russianVoices.length}):</h4>
                    ${russianVoices.map(voice => `
                        <div style="margin: 5px 0; padding: 5px; background: white; border-radius: 3px;">
                            <strong>${voice.name}</strong> - ${voice.lang} 
                            ${voice.localService ? '(–õ–æ–∫–∞–ª—å–Ω—ã–π)' : '(–û–Ω–ª–∞–π–Ω)'}
                            <button onclick="speakWithSettings('–¢–µ—Å—Ç –≥–æ–ª–æ—Å–∞ ${voice.name}', speechSynthesis.getVoices().find(v => v.name === '${voice.name}'))" style="margin-left: 10px; padding: 2px 8px; font-size: 10px;">–¢–µ—Å—Ç</button>
                        </div>
                    `).join('')}
                `;
            }
        }

        // –§–æ—Ä—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≥–æ–ª–æ—Å–æ–≤
        function forceLoadVoices() {
            const utterance = new SpeechSynthesisUtterance('');
            speechSynthesis.speak(utterance);
            speechSynthesis.cancel();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥–æ–ª–æ—Å–∞
            const loadVoices = () => {
                setTimeout(testMaleVoice, 500);
            };

            if (speechSynthesis.getVoices().length > 0) {
                loadVoices();
            } else {
                // –§–æ—Ä—Å–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É
                forceLoadVoices();
                setTimeout(loadVoices, 200);
                speechSynthesis.onvoiceschanged = loadVoices;
            }

            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É
            setTimeout(() => {
                if (speechSynthesis.getVoices().length === 0) {
                    forceLoadVoices();
                    setTimeout(loadVoices, 300);
                }
            }, 1000);
        });
    </script>
</body>
</html>
